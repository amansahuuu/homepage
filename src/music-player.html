<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MP3 Player</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .progress-bar {
        background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%);
      }
      .track-item:hover {
        background-color: rgba(59, 130, 246, 0.1);
      }
      .track-item.active {
        background-color: rgba(59, 130, 246, 0.2);
        border-left: 4px solid #3b82f6;
      }
    </style>
  </head>
  <body class="bg-gray-900 text-white min-h-screen">
    <div class="container mx-auto p-6 max-w-4xl">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1
          class="text-4xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent"
        >
          ðŸŽµ MP3 Player
        </h1>
        <p class="text-gray-400 mt-2">Upload and play your favorite music</p>
      </div>

      <!-- Upload Section -->
      <div
        class="bg-gray-800 rounded-lg p-6 mb-6 border-2 border-dashed border-gray-600 hover:border-blue-500 transition-colors"
      >
        <div class="text-center">
          <div class="mb-4">
            <svg
              class="mx-auto h-12 w-12 text-gray-400"
              stroke="currentColor"
              fill="none"
              viewBox="0 0 48 48"
            >
              <path
                d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>
          <label for="fileInput" class="cursor-pointer">
            <span
              class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-medium transition-colors"
            >
              Choose Audio Files
            </span>
            <input
              type="file"
              id="fileInput"
              class="hidden"
              multiple
              accept="audio/*"
            />
          </label>
          <p class="text-gray-400 mt-2">Support MP3, WAV, M4A files</p>
        </div>
      </div>

      <!-- Main Player -->
      <div class="bg-gray-800 rounded-lg p-6 mb-6">
        <!-- Now Playing -->
        <div class="text-center mb-6">
          <div
            class="w-32 h-32 mx-auto bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4"
          >
            <svg
              class="w-16 h-16 text-white"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                fill-rule="evenodd"
                d="M18 3a1 1 0 00-1.447-.894L8.763 6H5a3 3 0 000 6h.28l1.771 5.316A1 1 0 008 18h1a1 1 0 001-1v-4.382l6.553 3.276A1 1 0 0018 15V3z"
                clip-rule="evenodd"
              />
            </svg>
          </div>
          <h2 id="currentTrack" class="text-xl font-semibold text-white">
            No track selected
          </h2>
          <p id="currentArtist" class="text-gray-400">Select a song to play</p>
        </div>

        <!-- Progress Bar -->
        <div class="mb-6">
          <div class="flex justify-between text-sm text-gray-400 mb-2">
            <span id="currentTime">0:00</span>
            <span id="duration">0:00</span>
          </div>
          <div
            class="w-full bg-gray-700 rounded-full h-2 cursor-pointer"
            id="progressContainer"
          >
            <div
              class="progress-bar h-2 rounded-full transition-all duration-300"
              style="width: 0%"
              id="progressBar"
            ></div>
          </div>
        </div>

        <!-- Controls -->
        <div class="flex items-center justify-center space-x-6">
          <button
            id="shuffleBtn"
            class="text-gray-400 hover:text-white transition-colors"
          >
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M5 12a1 1 0 102 0V6.414l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L5 6.414V12zM15 8a1 1 0 10-2 0v5.586l-1.293-1.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L15 13.586V8z"
                clip-rule="evenodd"
              />
            </svg>
          </button>

          <button
            id="prevBtn"
            class="text-gray-400 hover:text-white transition-colors"
          >
            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
              <path
                d="M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z"
              />
            </svg>
          </button>

          <button
            id="playPauseBtn"
            class="bg-blue-600 hover:bg-blue-700 rounded-full p-4 transition-colors"
          >
            <svg
              id="playIcon"
              class="w-8 h-8"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                clip-rule="evenodd"
              />
            </svg>
            <svg
              id="pauseIcon"
              class="w-8 h-8 hidden"
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path
                fill-rule="evenodd"
                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z"
                clip-rule="evenodd"
              />
            </svg>
          </button>

          <button
            id="nextBtn"
            class="text-gray-400 hover:text-white transition-colors"
          >
            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
              <path
                d="M4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4A1 1 0 0010 6v2.798l-5.445-3.63z"
              />
            </svg>
          </button>

          <button
            id="repeatBtn"
            class="text-gray-400 hover:text-white transition-colors"
          >
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z"
                clip-rule="evenodd"
              />
            </svg>
          </button>
        </div>

        <!-- Volume Control -->
        <div class="flex items-center justify-center mt-6 space-x-3">
          <svg
            class="w-5 h-5 text-gray-400"
            fill="currentColor"
            viewBox="0 0 20 20"
          >
            <path
              fill-rule="evenodd"
              d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.797L4.828 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.828l3.555-3.797A1 1 0 019.383 3.076zM12 6a1 1 0 011.414 0C14.536 7.122 15 8.534 15 10s-.464 2.878-1.586 4A1 1 0 0112 13a1 1 0 010-1.414C12.756 11.334 13 10.691 13 10s-.244-1.334-.586-1.586A1 1 0 0112 6z"
              clip-rule="evenodd"
            />
          </svg>
          <input
            type="range"
            id="volumeSlider"
            min="0"
            max="100"
            value="50"
            class="w-24 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"
          />
        </div>
      </div>

      <!-- Playlist -->
      <div class="bg-gray-800 rounded-lg p-6">
        <h3 class="text-xl font-semibold mb-4">Playlist</h3>
        <div id="playlist" class="space-y-2">
          <div class="text-center text-gray-400 py-8">
            <svg
              class="mx-auto h-12 w-12 text-gray-500 mb-4"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"
              />
            </svg>
            <p>No songs in playlist</p>
            <p class="text-sm">Upload some audio files to get started</p>
          </div>
        </div>
      </div>
    </div>

    <audio id="audioPlayer" preload="metadata"></audio>

    <script>
      class MP3Player {
        constructor() {
          this.audio = document.getElementById("audioPlayer");
          this.playlist = [];
          this.currentIndex = 0;
          this.isPlaying = false;
          this.isShuffled = false;
          this.repeatMode = 0; // 0: no repeat, 1: repeat all, 2: repeat one

          this.initializeElements();
          this.bindEvents();
        }

        initializeElements() {
          this.fileInput = document.getElementById("fileInput");
          this.playPauseBtn = document.getElementById("playPauseBtn");
          this.playIcon = document.getElementById("playIcon");
          this.pauseIcon = document.getElementById("pauseIcon");
          this.prevBtn = document.getElementById("prevBtn");
          this.nextBtn = document.getElementById("nextBtn");
          this.shuffleBtn = document.getElementById("shuffleBtn");
          this.repeatBtn = document.getElementById("repeatBtn");
          this.progressContainer = document.getElementById("progressContainer");
          this.progressBar = document.getElementById("progressBar");
          this.currentTime = document.getElementById("currentTime");
          this.duration = document.getElementById("duration");
          this.volumeSlider = document.getElementById("volumeSlider");
          this.currentTrack = document.getElementById("currentTrack");
          this.currentArtist = document.getElementById("currentArtist");
          this.playlistContainer = document.getElementById("playlist");
        }

        bindEvents() {
          this.fileInput.addEventListener("change", (e) =>
            this.handleFileUpload(e)
          );
          this.playPauseBtn.addEventListener("click", () =>
            this.togglePlayPause()
          );
          this.prevBtn.addEventListener("click", () => this.previousTrack());
          this.nextBtn.addEventListener("click", () => this.nextTrack());
          this.shuffleBtn.addEventListener("click", () => this.toggleShuffle());
          this.repeatBtn.addEventListener("click", () => this.toggleRepeat());
          this.progressContainer.addEventListener("click", (e) => this.seek(e));
          this.volumeSlider.addEventListener("input", (e) =>
            this.setVolume(e.target.value)
          );

          this.audio.addEventListener("loadedmetadata", () =>
            this.updateDuration()
          );
          this.audio.addEventListener("timeupdate", () =>
            this.updateProgress()
          );
          this.audio.addEventListener("ended", () => this.handleTrackEnd());
        }

        handleFileUpload(event) {
          const files = Array.from(event.target.files);
          files.forEach((file) => {
            const url = URL.createObjectURL(file);
            const track = {
              name: file.name.replace(/\.[^/.]+$/, ""),
              file: file,
              url: url,
              duration: 0,
            };
            this.playlist.push(track);
          });
          this.renderPlaylist();
          if (this.playlist.length === 1) {
            this.loadTrack(0);
          }
        }

        renderPlaylist() {
          if (this.playlist.length === 0) {
            this.playlistContainer.innerHTML = `
                        <div class="text-center text-gray-400 py-8">
                            <svg class="mx-auto h-12 w-12 text-gray-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
                            </svg>
                            <p>No songs in playlist</p>
                            <p class="text-sm">Upload some audio files to get started</p>
                        </div>
                    `;
            return;
          }

          this.playlistContainer.innerHTML = this.playlist
            .map(
              (track, index) => `
                    <div class="track-item flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${
                      index === this.currentIndex ? "active" : ""
                    }" 
                         onclick="player.loadTrack(${index})">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 3a1 1 0 00-1.447-.894L8.763 6H5a3 3 0 000 6h.28l1.771 5.316A1 1 0 008 18h1a1 1 0 001-1v-4.382l6.553 3.276A1 1 0 0018 15V3z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div>
                                <p class="font-medium text-white">${
                                  track.name
                                }</p>
                                <p class="text-sm text-gray-400">Audio File</p>
                            </div>
                        </div>
                        <button onclick="event.stopPropagation(); player.removeTrack(${index})" 
                                class="text-gray-400 hover:text-red-500 transition-colors">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                `
            )
            .join("");
        }

        loadTrack(index) {
          if (index < 0 || index >= this.playlist.length) return;

          this.currentIndex = index;
          const track = this.playlist[index];
          this.audio.src = track.url;
          this.currentTrack.textContent = track.name;
          this.currentArtist.textContent = "Audio File";
          this.renderPlaylist();
        }

        togglePlayPause() {
          if (this.playlist.length === 0) return;

          if (this.isPlaying) {
            this.pause();
          } else {
            this.play();
          }
        }

        play() {
          this.audio.play();
          this.isPlaying = true;
          this.playIcon.classList.add("hidden");
          this.pauseIcon.classList.remove("hidden");
        }

        pause() {
          this.audio.pause();
          this.isPlaying = false;
          this.playIcon.classList.remove("hidden");
          this.pauseIcon.classList.add("hidden");
        }

        previousTrack() {
          if (this.playlist.length === 0) return;
          let newIndex = this.currentIndex - 1;
          if (newIndex < 0) newIndex = this.playlist.length - 1;
          this.loadTrack(newIndex);
          if (this.isPlaying) this.play();
        }

        nextTrack() {
          if (this.playlist.length === 0) return;
          let newIndex = this.currentIndex + 1;
          if (newIndex >= this.playlist.length) newIndex = 0;
          this.loadTrack(newIndex);
          if (this.isPlaying) this.play();
        }

        toggleShuffle() {
          this.isShuffled = !this.isShuffled;
          this.shuffleBtn.style.color = this.isShuffled ? "#3b82f6" : "";
        }

        toggleRepeat() {
          this.repeatMode = (this.repeatMode + 1) % 3;
          const colors = ["", "#3b82f6", "#10b981"];
          this.repeatBtn.style.color = colors[this.repeatMode];
        }

        seek(event) {
          const rect = this.progressContainer.getBoundingClientRect();
          const percent = (event.clientX - rect.left) / rect.width;
          this.audio.currentTime = percent * this.audio.duration;
        }

        setVolume(value) {
          this.audio.volume = value / 100;
        }

        updateDuration() {
          this.duration.textContent = this.formatTime(this.audio.duration);
        }

        updateProgress() {
          const percent = (this.audio.currentTime / this.audio.duration) * 100;
          this.progressBar.style.width = percent + "%";
          this.currentTime.textContent = this.formatTime(
            this.audio.currentTime
          );
        }

        handleTrackEnd() {
          if (this.repeatMode === 2) {
            this.audio.currentTime = 0;
            this.play();
          } else if (this.repeatMode === 1) {
            this.nextTrack();
          } else {
            if (this.currentIndex < this.playlist.length - 1) {
              this.nextTrack();
            } else {
              this.pause();
            }
          }
        }

        removeTrack(index) {
          URL.revokeObjectURL(this.playlist[index].url);
          this.playlist.splice(index, 1);

          if (index === this.currentIndex) {
            if (this.playlist.length === 0) {
              this.audio.src = "";
              this.currentTrack.textContent = "No track selected";
              this.currentArtist.textContent = "Select a song to play";
              this.pause();
            } else {
              const newIndex = Math.min(
                this.currentIndex,
                this.playlist.length - 1
              );
              this.loadTrack(newIndex);
            }
          } else if (index < this.currentIndex) {
            this.currentIndex--;
          }

          this.renderPlaylist();
        }

        formatTime(seconds) {
          if (isNaN(seconds)) return "0:00";
          const mins = Math.floor(seconds / 60);
          const secs = Math.floor(seconds % 60);
          return `${mins}:${secs.toString().padStart(2, "0")}`;
        }
      }

      const player = new MP3Player();
    </script>
  </body>
</html>
